function [theta_deg, delta_h_deg] = F16_pitch_for_trimmed_flight(KCAS, ZP_ft, ...
    DISA_K, gamma_deg, mass_t, xcg_per_MAC, disable_lef)
%
% Calculates the trimmed flight pitch of the F16 fighter, by solving
% the simplified longitudinal balance that assumes only two control
% surfaces (horizontal stabilator and leading edge flap):
%
%   q * S * CZ(alpha, delta_h, delta_lef) / W + cos(theta) = 0
%   CM(alpha, delta_h, delta_lef)                          = 0
%   alpha + gamma - theta                                  = 0
%   delta_lef - 1.38 * alpha_deg + 9.05 * q / p - 1.45     = 0
%
% Ref: "Simulator study of stall/post-stall characteristics of
% a fighter airplane with relaxed longitudinal static stability",
% L. T. Nguyen, NASA Technical Report, 1979.
%

% helper constants
g0_mps2 = 9.80665; % they use "9.81" in the Ref.
ft2m    = 0.3048;
kn2mps  = 0.514444;

W_ref_N        = (91188. / 9.81) * g0_mps2;
S_m2           = 300 * ft2m * ft2m;
xcg_ref_per_MAC = 0.35;


% parse inputs
if nargin < 3 || isempty(DISA_K)
    DISA_K = 0.;
end

if nargin < 4 || isempty(gamma_deg)
    gamma_deg = 0.;
end

if nargin < 5 || isempty(mass_t)
    mass_t = 1e-3 * W_ref_N / g0_mps2;
end

if nargin < 6 || isempty(xcg_per_MAC)
    xcg_per_MAC = xcg_ref_per_MAC;
end

if nargin < 7 || isempty(disable_lef)
    disable_lef = false;
end


% aerodynamic tables
CZ_beta0     = CZ_beta0_F16();
CZ_lef_beta0 = CZ_lef_beta0_F16();
CM_beta0     = CM_beta0_F16();
CM_lef_beta0 = CM_lef_beta0_F16();
eta_CM       = eta_CM_F16();
DCM_alpha    = DCM_alpha_F16();
DCM_ds       = DCM_ds_F16();


% flight condition
ZP_m                         = ZP_ft * ft2m;
[density, ~, ~, ~, pressure] = isa_atmos(ZP_m, DISA_K);
TAS                          = cas2tas(KCAS * kn2mps, ZP_m, DISA_K);
W_N                          = 1e3 * mass_t * g0_mps2;
qbar                         = 0.5 * density * TAS^2;
qS_div_W                     = qbar * S_m2 / W_N;
q_div_p                      = qbar / pressure;
Dxcg_per_MAC                  = xcg_ref_per_MAC - xcg_per_MAC;


% trim seed, using the simplest wind point formula
delta_hseed_deg = 0.;

dalpha = 0.1 * sqrt(eps);

CZ_p = CZ_tot_beta0(dalpha, delta_hseed_deg, ...
    delta_lef(dalpha, q_div_p, disable_lef), ...
    CZ_beta0, CZ_lef_beta0);

CZ_m = CZ_tot_beta0(-dalpha, delta_hseed_deg, ...
    delta_lef(-dalpha, q_div_p, disable_lef), ...
    CZ_beta0, CZ_lef_beta0);

CL_alpha = (CZ_m - CZ_p) / (2 * dalpha);

thetaseed_deg = cosd(gamma_deg) / (qS_div_W * CL_alpha) + gamma_deg;


% cost function
cost_function = @(x)(simplified_longitudinal_F16(x(1), x(2), ...
    gamma_deg, qS_div_W, disable_lef, q_div_p, ...
    CZ_beta0, CZ_lef_beta0, ...
    CM_beta0, CM_lef_beta0, eta_CM, DCM_alpha, DCM_ds, ...
    Dxcg_per_MAC));


% solve the unbounded simplified longitudinal balance with fsolve
% opts = optimoptions('fsolve', ...
%     'FiniteDifferenceType', 'central', ...
%     'FunctionTolerance', 1e-12, ...
%     'MaxFunctionEvaluations', 5000, ...
%     'Display', 'off');
%
% [x, ~, exitflag] = fsolve(cost_function, ...
%     [thetaseed_deg; delta_hseed_deg], opts);


% solve the bounded simplified longitudinal balance with lsqnonlin.
% We use the bounds that appear in the reference.
% theta_deg_limits   = [-20, 90];
% delta_h_deg_limits = [-25, 25];
%
% opts = optimoptions('lsqnonlin', ...
%     'FiniteDifferenceType', 'central', ...
%     'FunctionTolerance', 1e-12, ...
%     'MaxFunctionEvaluations', 5000, ...
%     'Display', 'off');
%
% [x, ~, ~, exitflag] = lsqnonlin(cost_function, ...
%     [thetaseed_deg; delta_hseed_deg], ...
%     [theta_deg_limits(1); delta_h_deg_limits(1)], [theta_deg_limits(2); delta_h_deg_limits(2)], ...
%     opts);


% solve the simplified longitudinal balance without the Optimization Toolbox...
delta_numjac  = 0.1 * sqrt(eps);
alpha         = 1.;
max_fun_evals = 5000;
tolf          = 1e-12;
tolx          = 1e-12;

[x, ~, exitflag] = numjac_Newton_method(cost_function, ...
    [thetaseed_deg; delta_hseed_deg], ...
    delta_numjac, alpha, max_fun_evals, tolf, tolx);


if exitflag ~= 1
    warning(['F16_pitch_for_trimmed_flight: the root finding algorithm', ...
        ' failed, result will be approximate.'])

    theta_deg   = thetaseed_deg;
    delta_h_deg = delta_hseed_deg;

else
    theta_deg   = x(1);
    delta_h_deg = x(2);

end

end


%
% Helper functions.
%

function cost = simplified_longitudinal_F16(theta_deg, delta_h_deg, ...
    gamma_deg, qS_div_W, disable_lef, q_div_p, ...
    CZ_beta0, CZ_lef_beta0, ...
    CM_beta0, CM_lef_beta0, eta_CM, DCM_alpha, DCM_ds, ...
    Dxcg_per_MAC)
%
% Simplified F16 longitudinal cost function for level flight, from the
% reference. Dxcg_div_MAC is (xcg_ref - xcg) / MAC
%

alpha_deg = theta_deg - gamma_deg;
dlef      = delta_lef(alpha_deg, q_div_p, disable_lef);

CZ = CZ_tot_beta0(alpha_deg, delta_h_deg, dlef, CZ_beta0, CZ_lef_beta0);
CM = CM_tot_beta0(alpha_deg, delta_h_deg, dlef, ...
    CM_beta0, CM_lef_beta0, eta_CM, DCM_alpha, DCM_ds, ...
    CZ, Dxcg_per_MAC);

cost = [qS_div_W * CZ + cosd(theta_deg); CM];

end


function val = delta_lef(alpha_deg, q_div_p, disable_lef)
%
% Stationary leading edge flap deflection, from the reference.
%

if ~disable_lef
    delta = 1.38 * alpha_deg - 9.05 * q_div_p + 1.45;    
else
    delta = 0.;    
end

val = (1. - delta / 25.);

end


function val = CZ_tot_beta0(alpha_deg, delta_h_deg, delta_lef, ...
    CZ_beta0, CZ_lef_beta0)
%
% Total normal force coefficient at zero sideslip, from the reference.
%

val = CZ_beta0(alpha_deg, delta_h_deg) + ...
    (CZ_lef_beta0(alpha_deg) - CZ_beta0(alpha_deg, 0.)) * delta_lef;

end


function val = CM_tot_beta0(alpha_deg, delta_h_deg, delta_lef, ...
    CM_beta0, CM_lef_beta0, eta_CM, DCM_alpha, DCM_ds, ...
    CZ_tot, Dxcg_div_MAC)
%
% Total normal force coefficient at zero sideslip, from the reference.
%

val = CM_beta0(alpha_deg, delta_h_deg) * eta_CM(delta_h_deg) + ...
    (CM_lef_beta0(alpha_deg) - CM_beta0(alpha_deg, 0.)) * delta_lef + ...
    CZ_tot * Dxcg_div_MAC + DCM_alpha(alpha_deg) + DCM_ds(alpha_deg, delta_h_deg);

end


function interpolant = CZ_beta0_F16()
%
% Normal force coefficient at zero sideslip
% for the F16 fighter, from the reference.
% It is CZ(alpha, beta, delta_h).
%

alpharows_deg = [-20.00000
    -15.00000
    -10.00000
    -5.00000
    0.00000
    5.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000
    35.00000
    40.00000
    45.00000
    50.00000
    55.00000
    60.00000
    70.00000
    80.00000
    90.00000];

betacols_deg = [-30.00000
    -25.00000
    -20.00000
    -15.00000
    -10.00000
    -8.00000
    -6.00000
    -4.00000
    -2.00000
    0.00000
    2.00000
    4.00000
    6.00000
    8.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000];

delta_h_deg = [-25
    -10
    0
    10
    25];

CZ_alpharows_betacols_dhm25 = [1.19400, 1.27200, 1.31100, 1.35600, 1.39600, 1.34700, 1.33900, 1.31400, 1.32100, 1.31500, 1.33700, 1.33200, 1.34000, 1.33800, 1.29400, 1.23500, 1.18500, 1.14000, 1.10000
    0.99600, 1.05700, 1.09000, 1.12100, 1.12800, 1.12900, 1.13100, 1.14300, 1.15800, 1.17100, 1.17700, 1.14200, 1.14800, 1.13100, 1.13700, 1.13000, 1.10000, 1.06000, 1.00500
    0.79300, 0.83200, 0.84100, 0.85600, 0.88700, 0.88880, 0.89900, 0.90900, 0.91500, 0.92500, 0.91000, 0.89200, 0.88900, 0.88100, 0.87500, 0.83500, 0.82100, 0.81500, 0.78000
    0.41000, 0.41000, 0.42000, 0.42500, 0.45100, 0.46400, 0.47400, 0.47200, 0.47400, 0.46900, 0.46000, 0.45400, 0.44700, 0.44600, 0.44000, 0.42400, 0.40500, 0.39400, 0.40300
    0.18000, 0.15500, 0.13500, 0.13000, 0.14100, 0.14900, 0.15400, 0.15300, 0.15100, 0.15500, 0.15400, 0.15100, 0.14700, 0.13800, 0.12900, 0.11900, 0.13700, 0.12300, 0.15900
    -0.09000, -0.13000, -0.16000, -0.18000, -0.18400, -0.18600, -0.18200, -0.18700, -0.18700, -0.18900, -0.19300, -0.19100, -0.19300, -0.19500, -0.19400, -0.18700, -0.17100, -0.13300, -0.09900
    -0.34000, -0.40500, -0.46000, -0.49800, -0.51100, -0.51800, -0.52600, -0.53500, -0.53400, -0.53000, -0.53200, -0.52500, -0.52000, -0.52100, -0.51500, -0.49800, -0.46500, -0.40200, -0.34100
    -0.61000, -0.66500, -0.72000, -0.77000, -0.80600, -0.81800, -0.83700, -0.84900, -0.85100, -0.85600, -0.85400, -0.85500, -0.85500, -0.83600, -0.82700, -0.80100, -0.73800, -0.66400, -0.60200
    -0.87000, -0.95000, -1.01500, -1.08000, -1.12200, -1.13700, -1.14900, -1.15400, -1.15600, -1.16900, -1.15100, -1.14800, -1.14600, -1.13500, -1.12900, -1.07700, -0.99400, -0.94300, -0.87300
    -1.17000, -1.23500, -1.29500, -1.35500, -1.40600, -1.40500, -1.42900, -1.44100, -1.44600, -1.44600, -1.45200, -1.44900, -1.45500, -1.44000, -1.41500, -1.35600, -1.28800, -1.21700, -1.16700
    -1.31500, -1.38000, -1.44500, -1.51500, -1.58100, -1.67100, -1.69700, -1.71400, -1.71900, -1.71700, -1.72000, -1.70900, -1.68400, -1.67000, -1.65100, -1.58000, -1.47700, -1.46300, -1.38900
    -1.52000, -1.57000, -1.63500, -1.71000, -1.78800, -1.81800, -1.83800, -1.88900, -1.91000, -1.90900, -1.90900, -1.89300, -1.89100, -1.84600, -1.80000, -1.72100, -1.64000, -1.59000, -1.53100
    -1.60000, -1.67000, -1.73000, -1.81000, -1.89100, -1.90700, -1.91100, -1.98300, -2.01600, -2.03700, -1.93200, -1.99000, -1.96900, -1.83600, -1.91800, -1.83900, -1.75500, -1.67100, -1.63000
    -1.56000, -1.61500, -1.68500, -1.75000, -1.85400, -1.99100, -2.03300, -1.93900, -2.00300, -1.98500, -2.02000, -2.04000, -1.91300, -1.91800, -1.94600, -1.91100, -1.82400, -1.68900, -1.66300
    -1.30000, -1.48000, -1.60000, -1.72000, -1.88000, -1.92400, -1.91300, -1.86600, -1.87900, -1.95900, -1.99200, -2.01700, -2.03000, -1.94200, -2.00200, -1.87000, -1.73800, -1.62300, -1.44700
    -1.70500, -1.79500, -1.82500, -1.85000, -1.93800, -1.95900, -2.01200, -1.99900, -1.96900, -2.01000, -1.96500, -1.84700, -1.89500, -1.92800, -1.96500, -1.75500, -1.69700, -1.70600, -1.61800
    -1.70000, -1.74000, -1.73000, -1.89500, -1.93300, -1.88000, -1.90700, -1.89800, -1.89200, -1.91600, -1.93600, -1.87700, -1.93300, -1.95200, -1.91500, -1.78000, -1.75000, -1.75000, -1.68800
    -1.69000, -1.74000, -1.73500, -1.83000, -1.81300, -1.86400, -2.00400, -1.95000, -1.92500, -1.95700, -1.90500, -1.83300, -1.93200, -1.95200, -1.89300, -1.80000, -1.85300, -1.79900, -1.79100
    -1.93500, -1.95000, -1.94500, -1.92000, -1.87200, -1.83800, -1.90800, -1.94900, -1.82600, -1.81600, -1.83700, -1.75500, -1.84800, -1.85800, -1.77400, -1.81000, -1.86400, -1.88500, -1.83400
    -1.96000, -1.93500, -1.85000, -1.87000, -1.95300, -2.03600, -2.01300, -1.96800, -1.99000, -1.97800, -1.95700, -1.95600, -1.96200, -2.04800, -1.97000, -1.89500, -1.89000, -1.96900, -1.97000];

CZ_alpharows_betacols_dhm10 = [1.14900, 1.21400, 1.26400, 1.29400, 1.32700, 1.28300, 1.26600, 1.24500, 1.23400, 1.22800, 1.25800, 1.25700, 1.26800, 1.26500, 1.23600, 1.19600, 1.15400, 1.10900, 1.06300
    0.94800, 0.99500, 1.02100, 1.04700, 1.04300, 1.04000, 1.03700, 1.04200, 1.05000, 1.05900, 1.06600, 1.04800, 1.05100, 1.04000, 1.05300, 1.05100, 1.03100, 0.99900, 0.95500
    0.75500, 0.77800, 0.77700, 0.78800, 0.80100, 0.79900, 0.80300, 0.80400, 0.81200, 0.81500, 0.81300, 0.80500, 0.80400, 0.80000, 0.79700, 0.77600, 0.76900, 0.76500, 0.74700
    0.32000, 0.32000, 0.32700, 0.33200, 0.35000, 0.36500, 0.37000, 0.37200, 0.35700, 0.35600, 0.35200, 0.34900, 0.34300, 0.33700, 0.32800, 0.31700, 0.30900, 0.29500, 0.30600
    0.08600, 0.06100, 0.04100, 0.03900, 0.05200, 0.05600, 0.06200, 0.06200, 0.06100, 0.06400, 0.06200, 0.06100, 0.05800, 0.05300, 0.04700, 0.03500, 0.04900, 0.04400, 0.07600
    -0.19200, -0.23200, -0.26200, -0.27900, -0.28000, -0.28400, -0.28100, -0.28700, -0.28700, -0.28700, -0.28900, -0.29100, -0.28900, -0.29100, -0.29300, -0.29200, -0.27500, -0.24400, -0.20500
    -0.45500, -0.52200, -0.57500, -0.61100, -0.62400, -0.63200, -0.64100, -0.64700, -0.65000, -0.65000, -0.65100, -0.64600, -0.64200, -0.63800, -0.63500, -0.62200, -0.58700, -0.52400, -0.46300
    -0.71400, -0.78400, -0.84600, -0.89800, -0.93300, -0.94900, -0.96700, -0.97600, -0.97700, -0.98000, -0.98000, -0.97800, -0.97700, -0.96300, -0.95100, -0.92300, -0.86400, -0.79000, -0.71700
    -1.00500, -1.08800, -1.16100, -1.22300, -1.26300, -1.28400, -1.29900, -1.30600, -1.30200, -1.30600, -1.29200, -1.28900, -1.28700, -1.27900, -1.26600, -1.22000, -1.14600, -1.09000, -1.00500
    -1.31300, -1.37800, -1.44500, -1.50900, -1.56000, -1.56600, -1.58300, -1.59000, -1.59500, -1.59400, -1.59700, -1.59500, -1.59500, -1.58400, -1.56600, -1.50500, -1.44500, -1.37400, -1.30700
    -1.41800, -1.49800, -1.57800, -1.66300, -1.74600, -1.82500, -1.84800, -1.86100, -1.86100, -1.86300, -1.86300, -1.85600, -1.83600, -1.81600, -1.79500, -1.73500, -1.61300, -1.55700, -1.47000
    -1.54200, -1.62900, -1.71900, -1.81900, -1.91900, -1.97700, -2.03300, -2.06400, -2.07900, -2.09000, -2.08100, -2.07500, -2.06700, -2.03400, -1.98900, -1.89600, -1.80000, -1.69600, -1.61300
    -1.67100, -1.76800, -1.86200, -1.96700, -2.07400, -2.07700, -2.15100, -2.18400, -2.19900, -2.21600, -2.19200, -2.19400, -2.08400, -2.11000, -2.11100, -1.99600, -1.90000, -1.78700, -1.70200
    -1.61500, -1.57700, -1.77000, -1.96300, -2.13000, -2.21700, -2.18400, -2.21600, -2.30600, -2.26300, -2.30400, -2.30400, -2.24200, -2.23500, -2.21000, -2.12100, -1.89100, -1.65400, -1.69600
    -1.40600, -1.59200, -1.71600, -1.94400, -2.02600, -2.08100, -2.08100, -2.03300, -2.03100, -2.09700, -2.11800, -2.13100, -2.14200, -2.06200, -2.12900, -2.04700, -1.81900, -1.69500, -1.50900
    -1.68800, -1.73800, -1.72100, -1.80900, -2.01400, -2.04800, -2.11200, -2.10000, -2.05800, -2.08800, -2.06700, -1.97200, -2.01600, -2.01900, -2.02500, -1.82000, -1.73200, -1.74900, -1.66900
    -1.72400, -1.79300, -1.80000, -1.75600, -1.94900, -1.92300, -1.97500, -1.99000, -2.00500, -2.05100, -2.02100, -1.91400, -1.95600, -1.99800, -1.98500, -1.79200, -1.83600, -1.82900, -1.76000
    -1.74300, -1.75400, -1.81100, -1.78100, -1.83900, -1.89700, -2.00400, -1.99900, -1.98600, -2.02700, -1.94300, -1.83500, -1.92500, -1.99300, -1.92100, -1.86300, -1.89300, -1.83600, -1.82500
    -1.93500, -1.99300, -1.97900, -1.99100, -1.92800, -1.87700, -1.93100, -1.98100, -1.89200, -1.91600, -1.93800, -1.85600, -1.94300, -1.94700, -1.84800, -1.91100, -1.89900, -1.91300, -1.85500
    -1.99000, -2.00900, -1.95000, -1.97900, -2.00600, -2.08500, -2.01900, -2.00700, -2.01900, -1.99800, -1.99000, -2.00400, -2.03600, -2.10200, -2.00300, -1.97600, -1.94700, -2.00600, -1.98700];

CZ_alpharows_betacols_dh0 = [1.09100, 1.14000, 1.20300, 1.21500, 1.23900, 1.20100, 1.17100, 1.15700, 1.12200, 1.11600, 1.15600, 1.16000, 1.17500, 1.17200, 1.16100, 1.14500, 1.11500, 1.07000, 1.01500
    0.90500, 0.93900, 0.95900, 0.98000, 0.96700, 0.96000, 0.95400, 0.95100, 0.95300, 0.95900, 0.96600, 0.96400, 0.96500, 0.95900, 0.97800, 0.98000, 0.97000, 0.94500, 0.91000
    0.71300, 0.71800, 0.70600, 0.71100, 0.70500, 0.69900, 0.69600, 0.68700, 0.69700, 0.69200, 0.70500, 0.70800, 0.71000, 0.71000, 0.70900, 0.71000, 0.71000, 0.71000, 0.71000
    0.26500, 0.26500, 0.27000, 0.27500, 0.28800, 0.30500, 0.30600, 0.31100, 0.28500, 0.28700, 0.28600, 0.28500, 0.28000, 0.27100, 0.26000, 0.25100, 0.25100, 0.23400, 0.24700
    -0.00600, -0.03000, -0.05000, -0.05000, -0.03600, -0.03500, -0.02800, -0.02700, -0.02700, -0.02500, -0.02800, -0.02800, -0.02900, -0.03100, -0.03400, -0.04800, -0.03700, -0.03300, -0.00600
    -0.27500, -0.31500, -0.34500, -0.36000, -0.35900, -0.36400, -0.36200, -0.36800, -0.36800, -0.36700, -0.36800, -0.37200, -0.36800, -0.37000, -0.37300, -0.37700, -0.36000, -0.33500, -0.29200
    -0.55000, -0.62000, -0.67000, -0.70500, -0.71900, -0.72700, -0.73700, -0.74100, -0.74700, -0.75000, -0.75000, -0.74600, -0.74400, -0.73600, -0.73500, -0.72500, -0.68900, -0.62600, -0.56400
    -0.82500, -0.91000, -0.98000, -1.03500, -1.06900, -1.08900, -1.10500, -1.11100, -1.11100, -1.11200, -1.11200, -1.10800, -1.10600, -1.09800, -1.08300, -1.05300, -0.99900, -0.92400, -0.84000
    -1.11500, -1.20000, -1.28000, -1.34000, -1.37900, -1.40500, -1.42100, -1.43100, -1.42200, -1.41800, -1.40800, -1.40500, -1.40300, -1.39600, -1.38200, -1.33600, -1.27100, -1.21000, -1.11300
    -1.37500, -1.44000, -1.51000, -1.57500, -1.62600, -1.63500, -1.65000, -1.65500, -1.65900, -1.65800, -1.66000, -1.65800, -1.65500, -1.64600, -1.63100, -1.57000, -1.51300, -1.44200, -1.36700
    -1.52000, -1.61500, -1.71000, -1.81000, -1.91000, -1.97700, -1.99700, -2.00600, -2.00200, -2.00800, -2.00600, -2.00100, -1.98100, -1.96100, -1.93900, -1.88800, -1.79900, -1.65100, -1.55000
    -1.55500, -1.66500, -1.77000, -1.88500, -1.99800, -2.07300, -2.15200, -2.17100, -2.18200, -2.20000, -2.18600, -2.18600, -2.17400, -2.14900, -2.10400, -2.00200, -1.89700, -1.76000, -1.66300
    -1.71500, -1.83000, -1.94500, -2.06500, -2.18800, -2.18300, -2.30100, -2.31000, -2.31400, -2.32800, -2.35500, -2.32100, -2.15600, -2.28100, -2.23100, -2.09500, -1.99100, -1.86000, -1.74700
    -1.62500, -1.57000, -1.78500, -2.00000, -2.17800, -2.27200, -2.21000, -2.26400, -2.35800, -2.31100, -2.35300, -2.35000, -2.29900, -2.29000, -2.25500, -2.15700, -2.00200, -1.64800, -1.70200
    -1.57000, -1.73500, -1.90000, -2.05000, -2.16500, -2.25400, -2.28800, -2.25800, -2.25800, -2.32600, -2.31200, -2.29000, -2.27700, -2.18400, -2.23900, -2.10900, -1.98600, -1.84800, -1.64900
    -1.77500, -1.90000, -1.97000, -2.05500, -2.17600, -2.18400, -2.22300, -2.21100, -2.19600, -2.25200, -2.23500, -2.14500, -2.18200, -2.16500, -2.15200, -2.02500, -1.96500, -1.93100, -1.80000
    -1.90000, -1.93500, -1.96000, -1.99500, -2.12800, -2.11100, -2.17300, -2.18300, -2.18100, -2.20800, -2.19000, -2.09400, -2.13100, -2.15000, -2.11400, -1.99000, -1.98600, -1.96200, -1.87600
    -1.93000, -1.94500, -1.94000, -1.92000, -1.92900, -2.02100, -2.16100, -2.16000, -2.12000, -2.13400, -2.08500, -2.01100, -2.10800, -2.12500, -2.06300, -1.97000, -2.01600, -1.94700, -1.92400
    -2.00000, -2.04500, -2.07500, -2.08000, -2.04500, -1.99400, -2.04800, -2.09200, -1.99200, -2.00400, -2.01900, -1.93000, -2.01400, -2.01800, -1.91900, -2.00000, -2.03400, -2.03200, -1.95800
    -1.96000, -1.95000, -1.90000, -2.01000, -2.06000, -2.15800, -2.11200, -2.11700, -2.14500, -2.14000, -2.11300, -2.10700, -2.10100, -2.16900, -2.07300, -2.07400, -2.03800, -2.08800, -2.06000];

CZ_alpharows_betacols_dh10 = [1.02100, 1.06600, 1.11600, 1.12600, 1.13900, 1.10800, 1.10300, 1.07000, 1.04100, 1.03900, 1.07100, 1.07600, 1.08900, 1.08600, 1.07800, 1.07000, 1.04600, 1.00700, 0.95700
    0.81500, 0.83800, 0.84600, 0.86300, 0.85400, 0.84800, 0.84400, 0.84100, 0.84600, 0.84900, 0.85600, 0.85200, 0.85300, 0.84800, 0.86300, 0.86300, 0.85600, 0.84100, 0.82000
    0.62200, 0.61800, 0.60300, 0.60900, 0.60600, 0.60200, 0.59900, 0.59200, 0.60000, 0.59600, 0.60500, 0.60700, 0.60900, 0.60900, 0.60900, 0.60700, 0.60700, 0.61100, 0.61900
    0.18100, 0.17600, 0.17900, 0.18400, 0.19800, 0.21200, 0.21300, 0.21500, 0.20200, 0.20500, 0.20200, 0.19800, 0.19200, 0.18300, 0.18000, 0.16500, 0.16300, 0.15500, 0.16900
    -0.06900, -0.10000, -0.12500, -0.13100, -0.12200, -0.12000, -0.11400, -0.11200, -0.11500, -0.11400, -0.11700, -0.11700, -0.12100, -0.12300, -0.12600, -0.13400, -0.12200, -0.10900, -0.07500
    -0.33900, -0.40000, -0.44400, -0.47400, -0.48000, -0.48000, -0.48100, -0.48600, -0.48700, -0.49000, -0.49000, -0.50400, -0.49600, -0.49100, -0.49300, -0.48300, -0.45800, -0.41200, -0.35400
    -0.58500, -0.63000, -0.71500, -0.76800, -0.80600, -0.81000, -0.82400, -0.83300, -0.84400, -0.84900, -0.85100, -0.84200, -0.84600, -0.83100, -0.82500, -0.80100, -0.75200, -0.67600, -0.59500
    -0.84300, -0.94700, -1.03100, -1.09700, -1.13300, -1.14700, -1.16700, -1.17500, -1.18200, -1.17700, -1.17100, -1.17600, -1.17500, -1.17100, -1.15800, -1.12000, -1.04700, -0.95400, -0.86400
    -1.10400, -1.20000, -1.28700, -1.35600, -1.40400, -1.43100, -1.44600, -1.45300, -1.44500, -1.44200, -1.43500, -1.43000, -1.43400, -1.42800, -1.41400, -1.35700, -1.28600, -1.21500, -1.11000
    -1.36200, -1.45800, -1.56000, -1.65500, -1.74100, -1.77100, -1.77100, -1.78200, -1.79400, -1.78900, -1.78700, -1.79100, -1.77500, -1.77500, -1.76000, -1.64600, -1.58200, -1.47300, -1.37000
    -1.52000, -1.63000, -1.74000, -1.85400, -1.96800, -2.03700, -2.07000, -2.08100, -2.08300, -2.08200, -2.08000, -2.07000, -2.05400, -2.03900, -2.01600, -1.92900, -1.79000, -1.67300, -1.56300
    -1.69000, -1.85600, -2.00600, -2.13600, -2.25200, -2.25500, -2.26000, -2.32600, -2.31700, -2.30800, -2.35500, -2.34100, -2.30200, -2.25900, -2.21900, -2.08100, -1.93800, -1.76000, -1.67900
    -1.84900, -1.94900, -2.05400, -2.16900, -2.29000, -2.36100, -2.34300, -2.37500, -2.28400, -2.41100, -2.41900, -2.40200, -2.34500, -2.33300, -2.30300, -2.16300, -2.06500, -1.97100, -1.87800
    -1.59000, -1.48400, -1.74100, -2.00000, -2.19300, -2.27900, -2.18600, -2.26200, -2.39500, -2.30600, -2.37300, -2.36900, -2.29500, -2.29300, -2.26200, -2.17500, -1.99300, -1.55500, -1.66100
    -1.70700, -1.89100, -2.01300, -2.25500, -2.14100, -2.20000, -2.20400, -2.16500, -2.17900, -2.26100, -2.28300, -2.28100, -2.29400, -2.18200, -2.21800, -2.17800, -1.93600, -1.81400, -1.63000
    -1.73500, -1.83800, -1.84400, -1.90400, -2.13300, -2.15900, -2.21700, -2.20900, -2.18400, -2.23100, -2.18600, -2.06800, -2.11500, -2.14500, -2.18000, -1.95100, -1.89100, -1.88500, -1.78200
    -1.79900, -1.88900, -1.91700, -1.94200, -2.09700, -2.06500, -2.11200, -2.12300, -2.14000, -2.18500, -2.16400, -2.06500, -2.10700, -2.14200, -2.12100, -1.96600, -1.94100, -1.91300, -1.82300
    -1.75300, -1.75200, -1.79700, -1.77900, -1.98700, -2.04800, -2.15700, -2.14900, -2.04800, -2.26800, -2.17800, -2.06400, -2.14200, -2.16100, -2.10200, -1.89400, -1.91200, -1.86700, -1.86800
    -2.06700, -2.12300, -2.10700, -2.14500, -2.05300, -1.91100, -1.97400, -2.02400, -1.92600, -1.94000, -1.96700, -1.89100, -1.97800, -1.97600, -1.87200, -1.96400, -1.92600, -1.94200, -1.88600
    -2.00800, -2.02000, -1.95500, -2.07600, -2.02600, -2.11600, -2.06100, -2.05700, -2.07300, -2.05700, -2.03400, -2.03300, -2.03000, -2.09500, -1.99600, -2.04600, -1.92500, -1.99000, -1.97800];


CZ_alpharows_betacols_dh25 = [0.72300, 0.75000, 0.74400, 0.74400, 0.71100, 0.70900, 0.69700, 0.69700, 0.69600, 0.71000, 0.70400, 0.71500, 0.72000, 0.72100, 0.72100, 0.75000, 0.75000, 0.74000, 0.71000
    0.51200, 0.49500, 0.46100, 0.46500, 0.47000, 0.47000, 0.47100, 0.46700, 0.48300, 0.47600, 0.48100, 0.47200, 0.47500, 0.47300, 0.47300, 0.46500, 0.47000, 0.49000, 0.51500
    0.24900, 0.21200, 0.18600, 0.19500, 0.20300, 0.20500, 0.20200, 0.20300, 0.20700, 0.20500, 0.20000, 0.19400, 0.19800, 0.19800, 0.20100, 0.18500, 0.19000, 0.21000, 0.25000
    0.10000, 0.09000, 0.09000, 0.09500, 0.11100, 0.12200, 0.12200, 0.12200, 0.12100, 0.12500, 0.12100, 0.11400, 0.10700, 0.09700, 0.10100, 0.08100, 0.07700, 0.07700, 0.09300
    -0.15000, -0.19000, -0.22000, -0.23500, -0.23200, -0.22400, -0.22400, -0.22100, -0.22700, -0.22800, -0.23100, -0.23200, -0.23900, -0.24100, -0.24400, -0.24400, -0.23200, -0.20700, -0.16400
    -0.38500, -0.46000, -0.51500, -0.55500, -0.56600, -0.56300, -0.56600, -0.57100, -0.57200, -0.57800, -0.57800, -0.59900, -0.58800, -0.57700, -0.57900, -0.55900, -0.52800, -0.46700, -0.39800
    -0.62000, -0.69000, -0.76000, -0.83000, -0.89200, -0.89100, -0.91000, -0.92400, -0.93900, -0.94600, -0.94900, -0.93600, -0.94500, -0.92400, -0.91300, -0.87600, -0.81300, -0.72400, -0.62600
    -0.86500, -0.99000, -1.09000, -1.17000, -1.20800, -1.21500, -1.23900, -1.25000, -1.26900, -1.25300, -1.24000, -1.25500, -1.25500, -1.25700, -1.24500, -1.19800, -1.10300, -0.99000, -0.89100
    -1.05500, -1.19500, -1.32000, -1.43000, -1.51900, -1.55000, -1.56400, -1.55800, -1.55500, -1.55400, -1.56300, -1.54900, -1.57700, -1.57800, -1.56300, -1.45300, -1.35800, -1.24100, -1.09700
    -1.36000, -1.46000, -1.57000, -1.67000, -1.76300, -1.79700, -1.79400, -1.80600, -1.82000, -1.81400, -1.81100, -1.81600, -1.79800, -1.80000, -1.78500, -1.66100, -1.59500, -1.47900, -1.37100
    -1.52000, -1.63500, -1.75000, -1.87000, -1.98900, -2.05800, -2.09500, -2.10700, -2.11200, -2.10800, -2.10600, -2.09400, -2.07900, -2.06600, -2.04300, -1.94300, -1.80400, -1.68100, -1.56800
    -1.61500, -1.75000, -1.87500, -1.99500, -2.11100, -2.15400, -2.20000, -2.24000, -2.24200, -2.24800, -2.26100, -2.25500, -2.23100, -2.19800, -2.15500, -2.03700, -1.91500, -1.76000, -1.67000
    -1.77500, -1.87500, -1.98000, -2.09500, -2.21600, -2.28700, -2.26900, -2.30100, -2.21000, -2.33700, -2.34500, -2.32800, -2.27100, -2.25900, -2.22900, -2.08900, -1.99100, -1.89700, -1.80400
    -1.74000, -1.84500, -1.92500, -2.00000, -2.13000, -2.25100, -2.28600, -2.27000, -2.23900, -2.32700, -2.28900, -2.28800, -2.31200, -2.28200, -2.23200, -2.09900, -2.03000, -1.94500, -1.83400
    -1.57000, -1.74000, -1.90000, -2.05000, -2.15600, -2.21600, -2.20300, -2.15800, -2.17500, -2.26100, -2.26600, -2.26200, -2.25500, -2.15300, -2.20100, -2.11000, -1.98400, -1.84100, -1.63700
    -1.70000, -1.81000, -1.88000, -1.95000, -2.04300, -2.17000, -2.18400, -2.11100, -2.20400, -2.23100, -2.20300, -2.10200, -2.13500, -2.17300, -2.10700, -1.95000, -1.89200, -1.87700, -1.76500
    -1.79500, -1.89500, -1.96000, -2.02000, -2.11300, -2.09400, -2.12400, -2.12400, -2.13400, -2.17400, -2.17700, -2.10300, -2.15300, -2.17600, -2.14400, -2.00000, -1.96000, -1.93000, -1.83800
    -1.78000, -1.78500, -1.79000, -1.81000, -1.87300, -1.94300, -2.05900, -2.27400, -2.00000, -2.25900, -2.21100, -1.88500, -2.22100, -2.21200, -2.12500, -1.97000, -1.90700, -1.88200, -1.87400
    -1.95000, -1.98000, -1.98000, -1.96000, -1.91100, -1.88100, -1.95500, -2.00500, -1.89400, -1.89900, -2.00900, -2.01400, -2.10100, -2.01400, -1.82500, -1.84000, -1.89900, -1.92200, -1.87300
    -1.92500, -1.92000, -1.87000, -1.88500, -1.96900, -2.07100, -2.02900, -2.03900, -2.07000, -2.06900, -2.02600, -2.00500, -2.00000, -2.08500, -2.00700, -1.93500, -1.94800, -1.98900, -1.95100];


% get the beta = 0 deg values and return the interpolant f(alpha, delta_h)
beta0 = betacols_deg == 0;

interpolant = griddedInterpolant({alpharows_deg, delta_h_deg}, ...
    [CZ_alpharows_betacols_dhm25(:, beta0), CZ_alpharows_betacols_dhm10(:, beta0), CZ_alpharows_betacols_dh0(:, beta0), CZ_alpharows_betacols_dh10(:, beta0), CZ_alpharows_betacols_dh25(:, beta0)]);

end


function interpolant = CZ_lef_beta0_F16()
%
% Normal force due to leading edge flap
% at zero sideslip, from the reference.
% It is f(alpha, beta).
%

alpharows_deg = [-20.00000
    -15.00000
    -10.00000
    -5.00000
    0.00000
    5.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000
    35.00000
    40.00000
    45.00000];

betacols_deg = [-30.00000
    -25.00000
    -20.00000
    -15.00000
    -10.00000
    -8.00000
    -6.00000
    -4.00000
    -2.00000
    0.00000
    2.00000
    4.00000
    6.00000
    8.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000];

CZ_lef_alpharows_betacols = [1.18300, 1.24600, 1.27900, 1.29000, 1.36900, 1.36400, 1.29700, 1.27700, 1.27600, 1.25600, 1.28100, 1.28000, 1.31200, 1.31500, 1.30600, 1.22700, 1.21600, 1.18300, 1.12000
    0.96000, 1.01800, 1.05500, 1.09300, 1.05800, 1.03900, 1.03100, 1.01900, 1.02500, 1.03500, 1.03300, 1.04200, 1.04300, 1.05600, 1.05600, 1.09100, 1.05300, 1.01600, 0.95800
    0.70900, 0.71000, 0.70200, 0.70400, 0.70100, 0.71000, 0.73000, 0.72900, 0.72900, 0.72500, 0.72900, 0.72800, 0.72800, 0.72300, 0.71100, 0.71400, 0.71200, 0.72000, 0.71900
    0.22200, 0.21600, 0.23100, 0.22700, 0.24000, 0.24300, 0.24400, 0.24900, 0.24900, 0.24800, 0.24800, 0.24200, 0.23900, 0.23500, 0.22900, 0.21600, 0.22000, 0.20500, 0.21100
    -0.06600, -0.08400, -0.09000, -0.10500, -0.10400, -0.09900, -0.10700, -0.09900, -0.09900, -0.10000, -0.10100, -0.10400, -0.10400, -0.10400, -0.10600, -0.10700, -0.09200, -0.08600, -0.06800
    -0.31700, -0.34700, -0.39000, -0.41400, -0.42000, -0.41700, -0.41700, -0.42100, -0.42400, -0.42800, -0.42100, -0.42800, -0.42200, -0.42300, -0.42500, -0.41900, -0.39500, -0.35200, -0.32200
    -0.56900, -0.61900, -0.67900, -0.70300, -0.72800, -0.76500, -0.77200, -0.77400, -0.77200, -0.77400, -0.77000, -0.76700, -0.76100, -0.75400, -0.75600, -0.73100, -0.70700, -0.64500, -0.59700
    -0.85300, -0.92900, -1.01800, -1.07000, -1.09800, -1.11600, -1.11440, -1.15100, -1.14200, -1.13900, -1.13500, -1.11800, -1.11200, -1.10700, -1.09900, -1.07100, -1.01900, -0.93000, -0.85400
    -1.10600, -1.16800, -1.22800, -1.31400, -1.34800, -1.35900, -1.36200, -1.35200, -1.35700, -1.35500, -1.37100, -1.37600, -1.37000, -1.37900, -1.39900, -1.36500, -1.27900, -1.21900, -1.15700
    -1.31400, -1.40700, -1.46500, -1.50600, -1.56400, -1.59800, -1.62800, -1.64700, -1.64600, -1.65000, -1.64200, -1.64100, -1.61800, -1.59900, -1.58500, -1.52700, -1.48600, -1.42800, -1.33500
    -1.49600, -1.51000, -1.58900, -1.69200, -1.77500, -1.81400, -1.84600, -1.87500, -1.87900, -1.88300, -1.89100, -1.87600, -1.84300, -1.83800, -1.81100, -1.72800, -1.62500, -1.54600, -1.53200
    -1.59400, -1.69400, -1.80700, -1.87500, -1.95700, -1.97600, -2.03200, -2.06000, -2.07000, -2.07700, -2.03800, -2.03900, -2.02800, -2.00500, -1.98600, -1.90400, -1.83600, -1.71300, -1.62300
    -1.68300, -1.75500, -1.91200, -1.99900, -2.11100, -2.14900, -2.14700, -2.20400, -2.20700, -2.20400, -2.20500, -2.19500, -2.19300, -2.17400, -2.13300, -2.02100, -1.93400, -1.77700, -1.70500
    -1.66400, -1.78300, -1.85900, -1.96200, -2.03000, -2.12900, -1.91700, -2.14300, -2.05000, -2.20800, -2.20100, -2.18200, -2.07700, -2.20900, -2.12600, -2.05800, -1.95500, -1.87900, -1.76000];


% get the beta = 0 deg values and return the interpolant f(alpha)
beta0 = betacols_deg == 0;

interpolant = griddedInterpolant(alpharows_deg, CZ_lef_alpharows_betacols(:, beta0));

end


function interpolant = CM_beta0_F16()
%
% Pitch moment coefficient at zero sideslip
% for the F16 fighter, from the reference.
% It is CM(alpha, beta, delta_h).
%

alpharows_deg = [-20.00000
    -15.00000
    -10.00000
    -5.00000
    0.00000
    5.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000
    35.00000
    40.00000
    45.00000
    50.00000
    55.00000
    60.00000
    70.00000
    80.00000
    90.00000];

betacols_deg = [-30.00000
    -25.00000
    -20.00000
    -15.00000
    -10.00000
    -8.00000
    -6.00000
    -4.00000
    -2.00000
    0.00000
    2.00000
    4.00000
    6.00000
    8.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000];

delta_h_deg = [-25
    -10
    0
    10
    25];

CM_alpharows_betacols_dhm25 = [0.20590, 0.19370, 0.19180, 0.18500, 0.16920, 0.16930, 0.17700, 0.17460, 0.17420, 0.17500, 0.17210, 0.17580, 0.18010, 0.18260, 0.19120, 0.20700, 0.21400, 0.21600, 0.22700
    0.16980, 0.16500, 0.17330, 0.17230, 0.15330, 0.16180, 0.16390, 0.16070, 0.15970, 0.15840, 0.15890, 0.16150, 0.15730, 0.15340, 0.14640, 0.16500, 0.16700, 0.15800, 0.16300
    0.14260, 0.15790, 0.18070, 0.16410, 0.15330, 0.15860, 0.15950, 0.16290, 0.16150, 0.15900, 0.15660, 0.15340, 0.15230, 0.14890, 0.14930, 0.15800, 0.17500, 0.15300, 0.13800
    0.16200, 0.17700, 0.15300, 0.14500, 0.13800, 0.13650, 0.13290, 0.12690, 0.12420, 0.12160, 0.11830, 0.12120, 0.12360, 0.12670, 0.13030, 0.13730, 0.14440, 0.16790, 0.15380
    0.15300, 0.15400, 0.14800, 0.14500, 0.14450, 0.14380, 0.14300, 0.14110, 0.14120, 0.14090, 0.14100, 0.14090, 0.14030, 0.14090, 0.14140, 0.14480, 0.14530, 0.15230, 0.15130
    0.14700, 0.15300, 0.15600, 0.15700, 0.15860, 0.15950, 0.15850, 0.15770, 0.15800, 0.15800, 0.15910, 0.15840, 0.15760, 0.15720, 0.15730, 0.15680, 0.15570, 0.15400, 0.14720
    0.15000, 0.16200, 0.16500, 0.17000, 0.17460, 0.17580, 0.17680, 0.17780, 0.18330, 0.18450, 0.18400, 0.18240, 0.18110, 0.17970, 0.17840, 0.17500, 0.17010, 0.16630, 0.15470
    0.16700, 0.17600, 0.19100, 0.19600, 0.20000, 0.20120, 0.20410, 0.20620, 0.20690, 0.20870, 0.20700, 0.20660, 0.20550, 0.20220, 0.20000, 0.19580, 0.19010, 0.17550, 0.16680
    0.15100, 0.17000, 0.19000, 0.20200, 0.20730, 0.20980, 0.21220, 0.21290, 0.21370, 0.21520, 0.21330, 0.21180, 0.21090, 0.20820, 0.20610, 0.19910, 0.18780, 0.16180, 0.14790
    0.12000, 0.14700, 0.17500, 0.19400, 0.20430, 0.20280, 0.20280, 0.19910, 0.19810, 0.19780, 0.19690, 0.19570, 0.19580, 0.19480, 0.19530, 0.18770, 0.16870, 0.14060, 0.11300
    0.10800, 0.06700, 0.09800, 0.15000, 0.17040, 0.19300, 0.19850, 0.20090, 0.20220, 0.20220, 0.20210, 0.20070, 0.19720, 0.19470, 0.19010, 0.16960, 0.11860, 0.08890, 0.12700
    0.08200, 0.04700, 0.06800, 0.08100, 0.11740, 0.12330, 0.15220, 0.17130, 0.17890, 0.18140, 0.18150, 0.17990, 0.17900, 0.17030, 0.14590, 0.11240, 0.09620, 0.07570, 0.11320
    0.11300, 0.05000, 0.06000, 0.08700, 0.11310, 0.12790, 0.13410, 0.14330, 0.14830, 0.14780, 0.12910, 0.13120, 0.12450, 0.10250, 0.10280, 0.07450, 0.04950, 0.04060, 0.10240
    0.09300, 0.06600, 0.06500, 0.05300, 0.07340, 0.09140, 0.09680, 0.08480, 0.09350, 0.09220, 0.09400, 0.08380, 0.06100, 0.04910, 0.04200, 0.02080, 0.03430, 0.03380, 0.06000
    -0.01500, -0.01100, -0.02500, 0.01500, 0.06630, 0.06440, 0.04980, 0.04070, 0.05210, 0.07450, 0.06700, 0.04530, 0.03730, 0.03200, 0.03970, -0.01140, -0.05140, -0.03710, -0.04080
    0.01900, 0.01700, -0.08600, -0.00400, 0.07940, 0.04940, 0.01740, 0.05300, 0.02920, 0.07130, 0.04040, 0.00070, -0.00240, 0.01650, 0.02810, -0.05620, -0.13730, -0.03430, -0.03350
    -0.03600, -0.02300, -0.07500, -0.06000, -0.06270, -0.07050, -0.05560, -0.05340, -0.05490, -0.05400, -0.06180, -0.06740, -0.08280, -0.08490, -0.10040, -0.09760, -0.11170, -0.05990, -0.07140
    -0.30700, -0.30800, -0.28500, -0.30500, -0.27690, -0.26480, -0.18280, -0.21150, -0.20320, -0.22440, -0.22640, -0.21950, -0.20540, -0.22030, -0.21910, -0.24790, -0.22760, -0.25180, -0.25030
    -0.36500, -0.39800, -0.40300, -0.38700, -0.34110, -0.33440, -0.34250, -0.34550, -0.32540, -0.33890, -0.35220, -0.31870, -0.32620, -0.32830, -0.32850, -0.37630, -0.39230, -0.38570, -0.35320
    -0.52600, -0.52700, -0.51500, -0.50400, -0.49000, -0.51570, -0.48010, -0.49700, -0.48310, -0.47230, -0.48300, -0.48180, -0.49110, -0.50740, -0.48630, -0.50010, -0.51240, -0.52270, -0.52190];

CM_alpharows_betacols_dhm10 = [0.14690, 0.12720, 0.12100, 0.10750, 0.07980, 0.07560, 0.08000, 0.08270, 0.08530, 0.08640, 0.07820, 0.08110, 0.08210, 0.08470, 0.09650, 0.12400, 0.13760, 0.14390, 0.16310
    0.10870, 0.09560, 0.09470, 0.08850, 0.05810, 0.05490, 0.05050, 0.04270, 0.03780, 0.03280, 0.03530, 0.04260, 0.04810, 0.04990, 0.05240, 0.08230, 0.08910, 0.08980, 0.10020
    0.07840, 0.07430, 0.08520, 0.06190, 0.03900, 0.03440, 0.02900, 0.02490, 0.01770, 0.00410, 0.01690, 0.02270, 0.02800, 0.03110, 0.03570, 0.05850, 0.08200, 0.07070, 0.07520
    0.05700, 0.06200, 0.04400, 0.03200, 0.01700, 0.01600, 0.01200, 0.00800, 0.01000, 0.00760, 0.00700, 0.00800, 0.01000, 0.01100, 0.01200, 0.02700, 0.03900, 0.05800, 0.05200
    0.05200, 0.05400, 0.04300, 0.03900, 0.04200, 0.04100, 0.04200, 0.04300, 0.04300, 0.04300, 0.04200, 0.04300, 0.03700, 0.03800, 0.03780, 0.04300, 0.04500, 0.05700, 0.05000
    0.05200, 0.04200, 0.05000, 0.05300, 0.05400, 0.05300, 0.05400, 0.05300, 0.05200, 0.05010, 0.05200, 0.05100, 0.05100, 0.05100, 0.05100, 0.05100, 0.04900, 0.04300, 0.05200
    0.02800, 0.03500, 0.04000, 0.04000, 0.04700, 0.04800, 0.05000, 0.05000, 0.05100, 0.05530, 0.05200, 0.05300, 0.05200, 0.05200, 0.05100, 0.04300, 0.04200, 0.03800, 0.03000
    0.04300, 0.04000, 0.05300, 0.06000, 0.06300, 0.06300, 0.06700, 0.06900, 0.07200, 0.07060, 0.07100, 0.07000, 0.07000, 0.06800, 0.06300, 0.05900, 0.05300, 0.04000, 0.04200
    0.02700, 0.02500, 0.04000, 0.05000, 0.05700, 0.05600, 0.05800, 0.06000, 0.06500, 0.06740, 0.06900, 0.06600, 0.06200, 0.05500, 0.05200, 0.04600, 0.03600, 0.02000, 0.02200
    0.01000, 0.00800, 0.02300, 0.03800, 0.04700, 0.04800, 0.04800, 0.04600, 0.04800, 0.04920, 0.04600, 0.04700, 0.04400, 0.04300, 0.04300, 0.03400, 0.01900, 0.00200, 0.00500
    0.01500, -0.03500, -0.01700, 0.00300, 0.02000, 0.04000, 0.04700, 0.04900, 0.05100, 0.05280, 0.04800, 0.04800, 0.04500, 0.04000, 0.03300, 0.01600, -0.00500, -0.02400, 0.02800
    0.01600, -0.02700, -0.03400, -0.02400, -0.00600, 0.00400, 0.01600, 0.02400, 0.03100, 0.02780, 0.02800, 0.02500, 0.01200, 0.01300, 0.00300, -0.02100, -0.02600, -0.02000, 0.02300
    0.06800, 0.01900, -0.01600, -0.01300, -0.00800, -0.00700, -0.00600, -0.00500, -0.00600, -0.00940, -0.02200, -0.02200, -0.04400, -0.03800, -0.04100, -0.04700, -0.05000, -0.01300, 0.03300
    0.02500, -0.02100, -0.02700, -0.05400, -0.05000, -0.03900, -0.05300, -0.05400, -0.03900, -0.04110, -0.04700, -0.05800, -0.07200, -0.07500, -0.08100, -0.08500, -0.05600, -0.05100, -0.00600
    -0.01110, 0.00000, -0.00700, -0.01050, 0.00730, -0.00850, -0.03710, -0.05190, -0.03790, -0.01290, -0.02210, -0.04550, -0.05420, -0.05940, -0.05150, -0.06930, -0.06580, -0.05880, -0.06990
    0.00020, 0.00430, -0.09360, -0.04250, 0.03590, 0.01340, -0.01100, -0.01690, -0.01130, 0.02020, -0.01310, -0.05530, -0.06020, -0.04240, -0.03190, -0.11040, -0.16140, -0.06350, -0.06760
    -0.08790, -0.03150, -0.03840, -0.17570, -0.09620, -0.10500, -0.09120, -0.08570, -0.07940, -0.07080, -0.08870, -0.10450, -0.12470, -0.12640, -0.14140, -0.22090, -0.08360, -0.07670, -0.13310
    -0.34290, -0.35790, -0.34300, -0.35640, -0.35200, -0.33630, -0.26910, -0.30050, -0.29240, -0.31370, -0.31130, -0.30010, -0.28680, -0.30760, -0.31240, -0.31680, -0.30340, -0.31820, -0.30330
    -0.42940, -0.47150, -0.48770, -0.48330, -0.43150, -0.42350, -0.42380, -0.43210, -0.41100, -0.42360, -0.44450, -0.41850, -0.42680, -0.42310, -0.41750, -0.46930, -0.47370, -0.45750, -0.41540
    -0.62080, -0.61730, -0.60280, -0.59590, -0.55320, -0.58810, -0.56170, -0.58590, -0.57730, -0.57180, -0.57280, -0.56180, -0.56800, -0.58780, -0.57020, -0.57890, -0.58580, -0.60030, -0.60380];

CM_alpharows_betacols_dh0 = [0.09780, 0.07190, 0.06210, 0.04300, 0.00540, -0.00230, -0.00060, 0.00620, 0.01140, 0.01270, 0.00010, 0.00230, 0.00060, 0.00330, 0.01770, 0.05500, 0.07400, 0.08400, 0.11000
    0.05600, 0.03570, 0.02640, 0.01630, -0.02400, -0.03720, -0.04720, -0.05900, -0.06740, -0.07550, -0.07120, -0.06000, -0.04600, -0.03930, -0.02870, 0.01100, 0.02200, 0.03100, 0.04600
    0.03420, 0.01670, 0.01940, -0.00890, -0.04100, -0.05100, -0.06080, -0.07000, -0.08130, -0.10250, -0.07930, -0.06730, -0.05760, -0.05000, -0.04240, -0.01000, 0.01800, 0.01400, 0.03200
    -0.02400, -0.02400, -0.03900, -0.05500, -0.07580, -0.07730, -0.08020, -0.08020, -0.07740, -0.07440, -0.07740, -0.07820, -0.07840, -0.07820, -0.07700, -0.05720, -0.04000, -0.02510, -0.02600
    -0.05500, -0.04600, -0.05900, -0.06400, -0.06600, -0.06600, -0.06390, -0.06150, -0.06050, -0.05980, -0.06000, -0.06060, -0.06080, -0.06170, -0.06210, -0.06060, -0.05870, -0.04840, -0.05170
    -0.04600, -0.06400, -0.05500, -0.05200, -0.05140, -0.05070, -0.05090, -0.05010, -0.04990, -0.04980, -0.05000, -0.05180, -0.05260, -0.05320, -0.05370, -0.05450, -0.05640, -0.06190, -0.06510
    -0.06700, -0.06200, -0.05600, -0.05300, -0.04950, -0.04840, -0.04670, -0.04570, -0.04440, -0.04370, -0.04480, -0.04580, -0.04800, -0.04900, -0.04980, -0.05340, -0.05550, -0.06190, -0.06580
    -0.06700, -0.07700, -0.06800, -0.05900, -0.05360, -0.05140, -0.04890, -0.04560, -0.04190, -0.04070, -0.04100, -0.04220, -0.04320, -0.04470, -0.04840, -0.05360, -0.06090, -0.07150, -0.06130
    -0.05700, -0.07100, -0.06200, -0.05200, -0.04780, -0.05180, -0.04980, -0.04630, -0.03840, -0.03420, -0.03290, -0.03660, -0.04260, -0.05320, -0.05550, -0.06200, -0.07050, -0.08000, -0.06600
    -0.06400, -0.08800, -0.07700, -0.06700, -0.05480, -0.05390, -0.05300, -0.05200, -0.04990, -0.05070, -0.05010, -0.05060, -0.05260, -0.05390, -0.05600, -0.06490, -0.07610, -0.08880, -0.06330
    -0.04500, -0.10500, -0.09200, -0.09200, -0.07820, -0.06080, -0.05290, -0.05000, -0.04710, -0.04590, -0.05100, -0.05200, -0.05420, -0.06120, -0.06800, -0.08470, -0.08490, -0.09710, -0.03640
    -0.02200, -0.07200, -0.09200, -0.08800, -0.07380, -0.06390, -0.05940, -0.05720, -0.05670, -0.06050, -0.06050, -0.06250, -0.07290, -0.07470, -0.08040, -0.09300, -0.09740, -0.07750, -0.02790
    0.04500, 0.00500, -0.05200, -0.06100, -0.06620, -0.07290, -0.07390, -0.07890, -0.08200, -0.08350, -0.09170, -0.09710, -0.12520, -0.10710, -0.11160, -0.10570, -0.09790, -0.04020, 0.00220
    -0.00100, -0.05200, -0.06000, -0.09200, -0.09270, -0.08610, -0.10560, -0.09660, -0.08620, -0.09230, -0.09750, -0.10800, -0.11680, -0.12090, -0.12430, -0.12340, -0.08970, -0.08200, -0.02940
    -0.00900, -0.01300, -0.01700, -0.03500, -0.07800, -0.07130, -0.07740, -0.08900, -0.09130, -0.08260, -0.08980, -0.11120, -0.12010, -0.12770, -0.12220, -0.12200, -0.08520, -0.06480, -0.06240
    -0.05100, -0.01800, -0.06500, -0.05300, -0.04770, -0.05200, -0.05830, -0.06630, -0.08300, -0.07380, -0.08510, -0.10530, -0.10500, -0.09880, -0.10000, -0.10760, -0.11520, -0.05890, -0.10470
    -0.18300, -0.14800, -0.17300, -0.17200, -0.15120, -0.14280, -0.11180, -0.10940, -0.12660, -0.14140, -0.14360, -0.14370, -0.15210, -0.14590, -0.15300, -0.17090, -0.17410, -0.14750, -0.18410
    -0.38300, -0.39800, -0.38200, -0.38700, -0.38690, -0.36370, -0.27060, -0.29670, -0.29440, -0.32160, -0.32520, -0.31990, -0.31230, -0.33850, -0.34870, -0.34860, -0.34450, -0.35930, -0.34440
    -0.48300, -0.51800, -0.52800, -0.50600, -0.48500, -0.47850, -0.48040, -0.48690, -0.46050, -0.46780, -0.48830, -0.46200, -0.47440, -0.47920, -0.48210, -0.50220, -0.52420, -0.51450, -0.47880
    -0.63300, -0.63000, -0.61600, -0.61600, -0.60670, -0.63660, -0.60530, -0.62810, -0.62170, -0.61840, -0.61630, -0.60220, -0.60730, -0.62810, -0.61150, -0.62090, -0.62100, -0.63510, -0.63810];

CM_alpharows_betacols_dh10 = [0.02000, -0.00360, -0.01070, -0.03340, -0.07780, -0.09440, -0.09260, -0.08550, -0.08150, -0.08350, -0.09550, -0.09300, -0.09430, -0.08810, -0.07430, -0.02650, -0.00400, 0.00340, 0.02680
    -0.01530, -0.03850, -0.05250, -0.07430, -0.12330, -0.13760, -0.14660, -0.15510, -0.16630, -0.17190, -0.16830, -0.15680, -0.14370, -0.13710, -0.12950, -0.07980, -0.05890, -0.04450, -0.02410
    -0.05490, -0.07920, -0.09320, -0.12260, -0.15210, -0.16090, -0.16880, -0.17740, -0.18800, -0.21530, -0.18390, -0.17380, -0.16480, -0.15940, -0.15250, -0.12250, -0.09310, -0.12760, -0.05480
    -0.11200, -0.12400, -0.15200, -0.16800, -0.18300, -0.18800, -0.19100, -0.19200, -0.18900, -0.18880, -0.19000, -0.19300, -0.19300, -0.19100, -0.18300, -0.16800, -0.15200, -0.12500, -0.11200
    -0.11700, -0.12700, -0.15200, -0.15900, -0.16000, -0.16000, -0.15900, -0.15700, -0.16200, -0.16100, -0.16200, -0.16300, -0.16700, -0.16200, -0.16200, -0.16200, -0.15300, -0.12600, -0.11700
    -0.10500, -0.13300, -0.14400, -0.15500, -0.15500, -0.15500, -0.15500, -0.15500, -0.15800, -0.16060, -0.16100, -0.16200, -0.15700, -0.15700, -0.15600, -0.15600, -0.14500, -0.13300, -0.11800
    -0.09700, -0.11200, -0.12200, -0.13500, -0.14200, -0.14200, -0.15100, -0.15300, -0.15700, -0.15480, -0.15500, -0.15200, -0.15300, -0.14500, -0.14600, -0.14000, -0.12600, -0.11700, -0.10400
    -0.09700, -0.11800, -0.13300, -0.15100, -0.15200, -0.15000, -0.15500, -0.15500, -0.15200, -0.14520, -0.14800, -0.15500, -0.15500, -0.15700, -0.15200, -0.15100, -0.13400, -0.11800, -0.09600
    -0.06200, -0.08300, -0.09700, -0.10600, -0.13400, -0.14200, -0.13800, -0.13400, -0.13000, -0.12640, -0.12600, -0.12600, -0.15100, -0.16100, -0.16600, -0.13700, -0.12600, -0.11500, -0.09400
    -0.07500, -0.10300, -0.11300, -0.10800, -0.13700, -0.14400, -0.15300, -0.15400, -0.15400, -0.15300, -0.15500, -0.15000, -0.15000, -0.16000, -0.16400, -0.13300, -0.13800, -0.12900, -0.09900
    -0.08800, -0.16800, -0.16500, -0.17200, -0.17100, -0.15500, -0.15000, -0.14700, -0.14400, -0.14400, -0.14500, -0.14600, -0.15300, -0.15700, -0.15600, -0.15900, -0.15200, -0.15500, -0.07500
    -0.10500, -0.16110, -0.18620, -0.20950, -0.19510, -0.17600, -0.15140, -0.14440, -0.14270, -0.14110, -0.14500, -0.15130, -0.15650, -0.16270, -0.17050, -0.18360, -0.16110, -0.13630, -0.08150
    -0.04380, -0.10790, -0.12810, -0.14850, -0.14050, -0.12720, -0.13010, -0.13670, -0.15550, -0.14500, -0.15430, -0.15950, -0.15270, -0.16440, -0.16820, -0.17910, -0.15530, -0.13620, -0.07440
    -0.14480, -0.09310, -0.13190, -0.17930, -0.15180, -0.12640, -0.10530, -0.15750, -0.18070, -0.14110, -0.16350, -0.16550, -0.16350, -0.18150, -0.18720, -0.22060, -0.16440, -0.13200, -0.19350
    -0.15300, -0.13300, -0.12800, -0.14700, -0.10770, -0.10300, -0.11110, -0.11540, -0.11610, -0.10080, -0.10600, -0.12540, -0.12730, -0.12280, -0.10520, -0.14420, -0.12530, -0.12860, -0.14980
    -0.07600, -0.06300, -0.15200, -0.05700, -0.00750, -0.04600, -0.08650, -0.06140, -0.09760, -0.06790, -0.09220, -0.12530, -0.12210, -0.09720, -0.07970, -0.13010, -0.22550, -0.13580, -0.14810
    -0.17100, -0.12000, -0.13500, -0.14000, -0.15880, -0.16340, -0.14550, -0.14440, -0.15120, -0.15560, -0.16530, -0.17190, -0.18660, -0.18590, -0.19850, -0.18080, -0.17580, -0.16210, -0.21160
    -0.40010, -0.40440, -0.37890, -0.40500, -0.34190, -0.33640, -0.26100, -0.27140, -0.22010, -0.19830, -0.23630, -0.26550, -0.26950, -0.28440, -0.28330, -0.37340, -0.34730, -0.37280, -0.36850
    -0.50820, -0.53380, -0.53330, -0.52530, -0.48770, -0.48480, -0.49020, -0.49700, -0.46770, -0.47210, -0.49290, -0.46690, -0.47760, -0.47870, -0.47790, -0.51550, -0.52350, -0.52400, -0.49840
    -0.63680, -0.63260, -0.61740, -0.62170, -0.59090, -0.62140, -0.59060, -0.61460, -0.60990, -0.60830, -0.60800, -0.59580, -0.59790, -0.61090, -0.58650, -0.61730, -0.61300, -0.62820, -0.63240];

CM_alpharows_betacols_dh25 = [-0.08180, -0.10230, -0.10600, -0.13340, -0.18660, -0.21490, -0.21280, -0.20550, -0.20300, -0.20930, -0.22040, -0.21760, -0.21850, -0.20770, -0.19460, -0.13300, -0.10600, -0.10200, -0.08200
    -0.11600, -0.14320, -0.16460, -0.20200, -0.26350, -0.27920, -0.28680, -0.29060, -0.30590, -0.30790, -0.30520, -0.29330, -0.28160, -0.27500, -0.27170, -0.20800, -0.17300, -0.15100, -0.12300
    -0.15270, -0.18450, -0.21680, -0.24800, -0.27400, -0.28160, -0.28740, -0.29520, -0.30250, -0.33910, -0.29880, -0.29070, -0.28250, -0.27940, -0.27340, -0.24600, -0.21500, -0.18300, -0.15000
    -0.17700, -0.20000, -0.23700, -0.25200, -0.26300, -0.26980, -0.27340, -0.27370, -0.27380, -0.27410, -0.27610, -0.27820, -0.27850, -0.27560, -0.26320, -0.25270, -0.23700, -0.20020, -0.17720
    -0.17400, -0.19700, -0.23400, -0.24700, -0.24870, -0.24860, -0.24930, -0.24890, -0.25390, -0.25270, -0.25240, -0.25240, -0.25320, -0.25170, -0.24910, -0.24910, -0.23590, -0.19830, -0.17480
    -0.16400, -0.19200, -0.21900, -0.24300, -0.24290, -0.24250, -0.24410, -0.24760, -0.25400, -0.25620, -0.25890, -0.25810, -0.24820, -0.24280, -0.24270, -0.24340, -0.21990, -0.19390, -0.16120
    -0.12800, -0.16200, -0.18800, -0.21600, -0.22970, -0.22890, -0.23910, -0.25190, -0.26260, -0.25540, -0.25990, -0.25300, -0.25010, -0.23670, -0.23300, -0.22200, -0.19380, -0.16640, -0.13380
    -0.11600, -0.14800, -0.18100, -0.21500, -0.21860, -0.21740, -0.22720, -0.22830, -0.22580, -0.21570, -0.21840, -0.22970, -0.23050, -0.23100, -0.21900, -0.21750, -0.18380, -0.15020, -0.11950
    -0.06800, -0.09300, -0.12400, -0.15400, -0.22030, -0.23110, -0.22720, -0.22050, -0.22050, -0.21650, -0.21820, -0.21380, -0.25890, -0.27050, -0.27510, -0.21110, -0.18110, -0.14820, -0.12270
    -0.07500, -0.10900, -0.13200, -0.13300, -0.18820, -0.21230, -0.22640, -0.23040, -0.23370, -0.23250, -0.23220, -0.22690, -0.22430, -0.23820, -0.24650, -0.18280, -0.18480, -0.15950, -0.12500
    -0.09700, -0.18600, -0.18600, -0.19800, -0.19890, -0.18280, -0.17980, -0.17620, -0.17510, -0.17400, -0.17320, -0.17820, -0.18550, -0.18750, -0.18520, -0.18240, -0.17320, -0.14780, -0.08140
    -0.10400, -0.16000, -0.18500, -0.20800, -0.19360, -0.17460, -0.15030, -0.14330, -0.14160, -0.14010, -0.14400, -0.15020, -0.15550, -0.16160, -0.16940, -0.18250, -0.16030, -0.13560, -0.08080
    -0.02500, -0.08400, -0.11200, -0.13000, -0.12480, -0.11570, -0.11820, -0.12450, -0.14000, -0.13200, -0.14110, -0.14630, -0.15320, -0.15230, -0.15620, -0.16360, -0.14320, -0.11590, -0.05820
    -0.05700, -0.06800, -0.08800, -0.12600, -0.11570, -0.10180, -0.10550, -0.12030, -0.12300, -0.11130, -0.12320, -0.13040, -0.13500, -0.14450, -0.14880, -0.16180, -0.11880, -0.10030, -0.09330
    -0.10800, -0.09300, -0.09300, -0.08700, -0.07450, -0.08940, -0.11980, -0.13880, -0.13660, -0.12340, -0.12540, -0.14160, -0.14630, -0.15080, -0.14210, -0.15500, -0.15850, -0.15880, -0.17710
    -0.12500, -0.11500, -0.20700, -0.10300, -0.05880, -0.08310, -0.10950, -0.07910, -0.11890, -0.09290, -0.11860, -0.15330, -0.15230, -0.13040, -0.11580, -0.15800, -0.26120, -0.17020, -0.18120
    -0.14300, -0.08200, -0.08500, -0.09100, -0.12510, -0.14920, -0.15070, -0.15700, -0.15890, -0.15840, -0.16890, -0.17730, -0.19470, -0.19820, -0.21500, -0.18080, -0.17370, -0.17190, -0.23330
    -0.42200, -0.43800, -0.42500, -0.43300, -0.33900, -0.32310, -0.23730, -0.25470, -0.22770, -0.23030, -0.35050, -0.19310, -0.18800, -0.23710, -0.27010, -0.36350, -0.35630, -0.36970, -0.35340
    -0.45000, -0.50000, -0.52400, -0.51400, -0.46330, -0.46480, -0.47460, -0.48620, -0.46210, -0.47160, -0.44740, -0.39160, -0.40820, -0.42990, -0.45930, -0.51130, -0.52020, -0.49610, -0.44600
    -0.56000, -0.59200, -0.51300, -0.59300, -0.56740, -0.60300, -0.57740, -0.60210, -0.59380, -0.58860, -0.58390, -0.56730, -0.57000, -0.58850, -0.56960, -0.59610, -0.61580, -0.59510, -0.56340];


% get the beta = 0 deg values and return the interpolant f(alpha, delta_h)
beta0 = betacols_deg == 0;

interpolant = griddedInterpolant({alpharows_deg, delta_h_deg}, ...
    [CM_alpharows_betacols_dhm25(:, beta0), CM_alpharows_betacols_dhm10(:, beta0), CM_alpharows_betacols_dh0(:, beta0), CM_alpharows_betacols_dh10(:, beta0), CM_alpharows_betacols_dh25(:, beta0)]);

end


function interpolant = CM_lef_beta0_F16()
%
% Pitch moment due to leading edge flap
% at zero sideslip, from the reference.
% It is CM_lef(alpha, beta).
%

alpharows_deg = [-20.00000
    -15.00000
    -10.00000
    -5.00000
    0.00000
    5.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000
    35.00000
    40.00000
    45.00000];

betacols_deg = [-30.00000
    -25.00000
    -20.00000
    -15.00000
    -10.00000
    -8.00000
    -6.00000
    -4.00000
    -2.00000
    0.00000
    2.00000
    4.00000
    6.00000
    8.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000];

CM_lef_alpharows_betacols = [0.09220, 0.05590, 0.05250, -0.03380, -0.05180, -0.06050, -0.05740, -0.05540, -0.05500, -0.05030, -0.05210, -0.04830, -0.04590, -0.04040, -0.03730, -0.01930, 0.06700, 0.07040, 0.10670
    0.03720, 0.00620, -0.00670, -0.02170, -0.07020, -0.08600, -0.10010, -0.10000, -0.10020, -0.10120, -0.09740, -0.09390, -0.08390, -0.08370, -0.07590, -0.02740, -0.01240, 0.00050, 0.03150
    0.02510, 0.00060, 0.00140, -0.02290, -0.05360, -0.06340, -0.06540, -0.06560, -0.06520, -0.06470, -0.06530, -0.06590, -0.06540, -0.06310, -0.05700, -0.02630, -0.00200, -0.00280, 0.02170
    -0.00060, -0.01930, -0.02340, -0.03210, -0.03860, -0.03890, -0.03850, -0.03860, -0.03880, -0.03870, -0.03890, -0.03870, -0.03880, -0.03920, -0.03860, -0.03210, -0.02340, -0.01930, -0.00060
    -0.02730, -0.02460, -0.02300, -0.02310, -0.02590, -0.02550, -0.02860, -0.02710, -0.02710, -0.02670, -0.02660, -0.02720, -0.02800, -0.02670, -0.02700, -0.02420, -0.02410, -0.02570, -0.02840
    -0.03190, -0.02720, -0.02040, -0.01700, -0.01520, -0.01480, -0.01450, -0.01380, -0.01270, -0.01280, -0.01330, -0.01410, -0.01490, -0.01570, -0.01640, -0.01820, -0.02160, -0.02870, -0.03310
    -0.04460, -0.03680, -0.02660, -0.01660, -0.01270, -0.01130, -0.00920, -0.00570, -0.00330, -0.00160, -0.00170, -0.00250, -0.00380, -0.00490, -0.00850, -0.01240, -0.02240, -0.03260, -0.04040
    -0.06820, -0.05870, -0.04250, -0.01970, 0.00000, 0.00260, 0.00780, 0.01580, 0.02430, 0.03230, 0.03280, 0.02900, 0.01890, 0.01200, 0.00610, -0.01360, -0.03640, -0.05260, -0.06210
    -0.09470, -0.08510, -0.06420, -0.05360, -0.03080, -0.02930, -0.02750, -0.02340, -0.01880, -0.01610, -0.01410, -0.01360, -0.01540, -0.01800, -0.02730, -0.05010, -0.06070, -0.08160, -0.09120
    -0.10900, -0.12350, -0.09380, -0.07770, -0.06740, -0.06480, -0.16070, -0.05580, -0.05260, -0.04550, -0.04710, -0.04790, -0.05300, -0.05630, -0.06100, -0.07130, -0.08740, -0.11710, -0.10260
    -0.01350, -0.08570, -0.09070, -0.10130, -0.08750, -0.09830, -0.09510, -0.09130, -0.09020, -0.08710, -0.08650, -0.08960, -0.09620, -0.09970, -0.10600, -0.11980, -0.10920, -0.10420, -0.03200
    0.02020, -0.05100, -0.08910, -0.10860, -0.10180, -0.10140, -0.11050, -0.11170, -0.11270, -0.11510, -0.11670, -0.12300, -0.13010, -0.13870, -0.14020, -0.14700, -0.12750, -0.08940, -0.01420
    -0.01160, -0.06390, -0.09710, -0.11560, -0.11700, -0.11420, -0.11820, -0.11600, -0.11780, -0.12060, -0.12800, -0.13470, -0.14360, -0.15120, -0.15160, -0.15020, -0.13170, -0.09850, -0.04620
    -0.00230, -0.01640, -0.04170, -0.09870, -0.09850, -0.09750, -0.12780, -0.10420, -0.11560, -0.09790, -0.11220, -0.12250, -0.14440, -0.13400, -0.14610, -0.14630, -0.08930, -0.06400, -0.04990];


% get the beta = 0 deg values and return the interpolant f(alpha)
beta0 = betacols_deg == 0;

interpolant = griddedInterpolant(alpharows_deg, CM_lef_alpharows_betacols(:, beta0));

end


function interpolant = eta_CM_F16()
%
% Stabilator efficiency factor over the
% pitch moment, from the reference.
% It is eta_CM(delta_h).
%

delta_hrows_deg = [-25
    -10
    0
    10
    25];

eta_CM_delta_hrows = [1.00000
    1.00000
    1.00000
    1.00000
    0.95000];


interpolant = griddedInterpolant(delta_hrows_deg, eta_CM_delta_hrows);

end


function interpolant = DCM_alpha_F16()
%
% Pitch moment increment, from the reference.
% It is DCM(alpha).
%

alpharows_deg = [-20.00000
    -15.00000
    -10.00000
    -5.00000
    0.00000
    5.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000
    35.00000
    40.00000
    45.00000
    50.00000
    55.00000
    60.00000
    70.00000
    80.00000
    90.00000];

DCM_alpha_alpharows = [0.01900
    0.01900
    0.01900
    0.01900
    0.01900
    0.01900
    0.02000
    0.04000
    0.04000
    0.05000
    0.06000
    0.06000
    0.06000
    0.06000
    0.06000
    0.06000
    0.06000
    0.06000
    0.06000
    0.06000];


interpolant = griddedInterpolant(alpharows_deg, DCM_alpha_alpharows);

end


function interpolant = DCM_ds_F16()
%
% Pitch moment due to deep stall, from
% the reference. It is f(alpha, delta_h).
%

alpharows_deg = [-20.00000
    -15.00000
    -10.00000
    -5.00000
    0.00000
    5.00000
    10.00000
    15.00000
    20.00000
    25.00000
    30.00000
    35.00000
    40.00000
    45.00000
    50.00000
    55.00000
    60.00000
    70.00000
    80.00000
    90.00000];

delta_hcols_deg = [-25
    -10
    0
    10
    25];

DCM_ds_alpharows_delta_hcols = [0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.00000, 0.00000, 0.00000, 0.00000
    0.00000, 0.01000, 0.01000, 0.02000, 0.02540
    0.04800, 0.05700, 0.06400, 0.07000, 0.04070
    0.03900, 0.05400, 0.10500, 0.07500, 0.08220
    0.00000, 0.02500, 0.07500, 0.04000, 0.05830
    0.08400, 0.08000, 0.10600, 0.10000, 0.07850
    0.09900, 0.07500, 0.13200, 0.02000, 0.04680
    0.02000, 0.01000, 0.05000, 0.00000, -0.02100
    0.00000, 0.01000, 0.04000, 0.00000, -0.03780];


interpolant = griddedInterpolant({alpharows_deg, delta_hcols_deg}, ...
    DCM_ds_alpharows_delta_hcols);

end
